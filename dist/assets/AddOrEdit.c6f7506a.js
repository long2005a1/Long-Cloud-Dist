import{d as h,e as I,cc as k,aW as g,b9 as u,c as e,a6 as _,bN as F,S as v,at as p,by as a,bl as l,D as m,bO as S,K as D,aF as q,cb as f,G as L,ba as c,n as T,au as U,cR as E,aa as M}from"./index.b1d62c55.js";import{a as R}from"./FolderTree.e745d3f4.js";import"./index.7e74510d.js";const O=r=>{const d=h();return e(a,{display:"inline-flex",flexDirection:"row",alignItems:"center",gap:"$2",rounded:"$md",shadow:"$md",p:"$2",w:"fit-content",get children(){return[e(l,{mb:"0",get children(){return d(`users.permissions.${r.name}`)}}),e(f,{get checked(){return r.can},onChange:()=>r.onChange(!r.can)})]}})},G=()=>{const r=h(),{params:d,back:b}=I(),{id:i}=d,[n,t]=k({id:0,username:"",password:"",base_path:"",role:0,permission:0,disabled:!1,sso_id:""}),[w,$]=g(()=>u.get(`/admin/user/get?id=${i}`));i&&(async()=>{const s=await $();c(s,t)})();const[y,x]=g(()=>u.post(`/admin/user/${i?"update":"create"}`,n));return e(M,{get loading(){return w()},get children(){return e(_,{w:"$full",alignItems:"start",spacing:"$2",get children(){return[e(F,{get children(){return r(`global.${i?"edit":"add"}`)}}),e(v,{get when(){return!p.is_guest(n)},get children(){return[e(a,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(l,{for:"username",display:"flex",alignItems:"center",get children(){return r("users.username")}}),e(m,{id:"username",get value(){return n.username},onInput:s=>t("username",s.currentTarget.value)})]}}),e(a,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(l,{for:"password",display:"flex",alignItems:"center",get children(){return r("users.password")}}),e(m,{id:"password",type:"password",placeholder:"********",get value(){return n.password},onInput:s=>t("password",s.currentTarget.value)})]}})]}}),e(a,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(l,{for:"base_path",display:"flex",alignItems:"center",get children(){return r("users.base_path")}}),e(R,{id:"base_path",get value(){return n.base_path},onChange:s=>t("base_path",s),onlyFolder:!0})]}}),e(a,{w:"$full",required:!0,get children(){return[e(l,{display:"flex",alignItems:"center",get children(){return r("users.permission")}}),e(S,{w:"$full",wrap:"wrap",gap:"$2",get children(){return e(D,{each:q,children:(s,o)=>e(O,{name:s,get can(){return p.can(n,o())},onChange:C=>{C?t("permission",n.permission|=1<<o()):t("permission",n.permission&=~(1<<o()))}})})}})]}}),e(a,{w:"fit-content",display:"flex",get children(){return e(f,{css:{whiteSpace:"nowrap"},id:"disabled",onChange:s=>t("disabled",s.currentTarget.checked),color:"$neutral10",fontSize:"$sm",get checked(){return n.disabled},get children(){return r("users.disabled")}})}}),e(L,{get loading(){return y()},onClick:async()=>{const s=await x();c(s,async()=>{T.success(r("global.save_success")),n.username===U().username&&c(await u.get("/me"),E),b()})},get children(){return r(`global.${i?"save":"add"}`)}})]}})}})};export{G as default};
